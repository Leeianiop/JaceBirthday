<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Countdown & Player Example</title>
<style>
  body { background: #f0f0f0; display: flex; flex-direction: column; align-items: center; }
  canvas { background: #fff; margin-top: 20px; border: 1px solid #000; }
</style>
</head>
<body>

<h1 id="countdown"></h1>
<canvas id="gameCanvas" width="800" height="400"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// --- Countdown setup ---
function getNextCountdown() {
    const now = new Date();
    let target = new Date(now.getFullYear(), 7, 13); // August
    if (now > target) target.setFullYear(now.getFullYear() + 1);
    return target;
}
let targetDate = getNextCountdown();

// --- Load images ---
const playerImages = {
    right: [new Image(), new Image()],
    left: [new Image(), new Image()]
};
playerImages.right[0].src = "player_right1.png";
playerImages.right[1].src = "player_right2.png";
playerImages.left[0].src = "player_left1.png";
playerImages.left[1].src = "player_left2.png";

const cakeImages = [new Image(), new Image()];
cakeImages[0].src = "cake normal.png";
cakeImages[1].src = "cake eaten.png";

// --- Player setup ---
let player = { x: 400, y: 300, width: 50, height: 60, dir: "right", frame: 0, jumping: false, jumpProgress: 0 };
const playerSpeed = 5;
const jumpHeight = 40;

// --- Cake setup ---
let cake = { x: 600, y: 300, width: 60, height: 60, frame: 0 };

// --- Key handling ---
const keys = {};
document.addEventListener('keydown', (e) => keys[e.key.toLowerCase()] = true);
document.addEventListener('keyup', (e) => keys[e.key.toLowerCase()] = false);

// --- Game loop ---
function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Countdown
    const now = new Date();
    let diff = targetDate - now;
    if (diff <= 0) targetDate = getNextCountdown();
    diff = targetDate - now;
    const days = Math.floor(diff / (1000*60*60*24));
    const hours = Math.floor((diff / (1000*60*60)) % 24);
    const minutes = Math.floor((diff / (1000*60)) % 60);
    const seconds = Math.floor((diff / 1000) % 60);
    document.getElementById('countdown').innerText = `${days}d ${hours}h ${minutes}m ${seconds}s`;

    // --- Player movement ---
    if (keys['arrowleft']) { player.x -= playerSpeed; player.dir="left"; player.frame=(player.frame+1)%2; }
    else if (keys['arrowright']) { player.x += playerSpeed; player.dir="right"; player.frame=(player.frame+1)%2; }
    else { player.frame = 0; }

    // Jump
    if (keys['arrowup'] && !player.jumping) { player.jumping = true; player.jumpProgress = 0; }
    if (player.jumping) {
        player.y -= 5;
        player.jumpProgress++;
        if (player.jumpProgress >= jumpHeight/5) player.jumping = false;
    } else if (player.y < 300) { player.y += 5; } // fall back down

    // --- Cake interaction ---
    cake.frame = keys['a'] ? 1 : 0;

    // --- Draw player ---
    const pImg = playerImages[player.dir][player.frame];
    ctx.drawImage(pImg, player.x, player.y, player.width, player.height);

    // --- Draw cake ---
    const cImg = cakeImages[cake.frame];
    ctx.drawImage(cImg, cake.x, cake.y, cake.width, cake.height);
    ctx.fillStyle = "black";
    ctx.font = "16px Arial";
    ctx.fillText("Press A to eat", cake.x + 5, cake.y - 10);

    requestAnimationFrame(gameLoop);
}
gameLoop();
</script>

</body>
</html>

