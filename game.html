import pygame
import os
import sys

pygame.init()

# --- Window setup ---
WIDTH, HEIGHT = 640, 480
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("2 Frame Animation Example")

# --- Clock and font ---
clock = pygame.time.Clock()
font = pygame.font.Font(None, 36)

# --- Load images ---
def load_image(name):
    path = os.path.join("images", name)
    return pygame.image.load(path).convert_alpha()

frames = {
    "up":    [load_image("up_1.png"), load_image("up_2.png")],
    "down":  [load_image("down_1.png"), load_image("down_2.png")],
    "left":  [load_image("left_1.png"), load_image("left_2.png")],
    "right": [load_image("right_1.png"), load_image("right_2.png")]
}

# --- Player setup ---
player_x, player_y = WIDTH // 2, HEIGHT // 2
player_speed = 4
direction = "down"
frame_index = 0
frame_counter = 0
frame_delay = 10  # Switch every 10 ticks

# --- Jump variables ---
is_jumping = False
jump_speed = 10
gravity = 0.5
jump_velocity = 0

# --- Timer ---
start_ticks = pygame.time.get_ticks()

# --- Main loop ---
running = True
while running:
    dt = clock.tick(60)  # 60 FPS

    # --- Event handling ---
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit()

        if event.type == pygame.KEYDOWN:
            if event.key == pygame.K_SPACE and not is_jumping:
                is_jumping = True
                jump_velocity = -jump_speed

    # --- Key state ---
    keys = pygame.key.get_pressed()
    moving = False
    if keys[pygame.K_UP]:
        player_y -= player_speed
        direction = "up"
        moving = True
    elif keys[pygame.K_DOWN]:
        player_y += player_speed
        direction = "down"
        moving = True
    elif keys[pygame.K_LEFT]:
        player_x -= player_speed
        direction = "left"
        moving = True
    elif keys[pygame.K_RIGHT]:
        player_x += player_speed
        direction = "right"
        moving = True

    # --- Animation update ---
    if moving:
        frame_counter += 1
        if frame_counter >= frame_delay:
            frame_counter = 0
            frame_index = (frame_index + 1) % 2
    else:
        frame_index = 0

    # --- Jump physics ---
    if is_jumping:
        player_y += jump_velocity
        jump_velocity += gravity
        if player_y >= HEIGHT // 2:
            player_y = HEIGHT // 2
            is_jumping = False

    # --- Draw ---
    screen.fill((50, 150, 200))

    # Draw player
    screen.blit(frames[direction][frame_index], (player_x, player_y))

    # Draw timer
    seconds = (pygame.time.get_ticks() - start_ticks) // 1000
    timer_surface = font.render(f"Time: {seconds}s", True, (255, 255, 255))
    screen.blit(timer_surface, (10, 10))

    pygame.display.flip()

